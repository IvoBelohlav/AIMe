/* Avatar Animations */
@keyframes blink {
  0%, 95%, 100% { opacity: 0; }
  5%, 90% { opacity: 1; }
}

@keyframes headBobble {
  0% { transform: rotate(0deg) translateY(0px); }
  25% { transform: rotate(1deg) translateY(-1px); }
  75% { transform: rotate(-1deg) translateY(1px); }
  100% { transform: rotate(0deg) translateY(0px); }
}

@keyframes breathe {
  0% { transform: translateY(0) scale(1); }
  50% { transform: translateY(2px) scale(1.01); }
  100% { transform: translateY(0) scale(1); }
}

@keyframes waveHand {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(-15deg); }
  50% { transform: rotate(0deg); }
  75% { transform: rotate(-15deg); }
  100% { transform: rotate(0deg); }
}

@keyframes nodHead {
  0% { transform: rotate(0deg); }
  20% { transform: rotate(3deg); }
  60% { transform: rotate(-1deg); }
  100% { transform: rotate(0deg); }
}

@keyframes shakeHead {
  0% { transform: rotate(0deg); }
  20% { transform: rotate(-3deg); }
  50% { transform: rotate(0deg); }
  80% { transform: rotate(3deg); }
  100% { transform: rotate(0deg); }
}

@keyframes shrug {
  0% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
  100% { transform: translateY(0); }
}

@keyframes excited {
  0% { transform: rotate(0deg) translateY(0); }
  15% { transform: rotate(2deg) translateY(-3px); }
  30% { transform: rotate(-2deg) translateY(-3px); }
  45% { transform: rotate(2deg) translateY(-3px); }
  60% { transform: rotate(-2deg) translateY(-3px); }
  75% { transform: rotate(1deg) translateY(-1px); }
  100% { transform: rotate(0deg) translateY(0); }
}

@keyframes pupilMove {
  0% { transform: translate(0, 0); }
  25% { transform: translate(1px, 1px); }
  50% { transform: translate(0, 0); }
  75% { transform: translate(-1px, 1px); }
  100% { transform: translate(0, 0); }
}

@keyframes leftArmIdle {
  0% { transform: rotate(0deg); }
  30% { transform: rotate(2deg); }
  60% { transform: rotate(-1deg); }
  100% { transform: rotate(0deg); }
}

@keyframes rightArmIdle {
  0% { transform: rotate(0deg); }
  40% { transform: rotate(-2deg); }
  70% { transform: rotate(1deg); }
  100% { transform: rotate(0deg); }
}

@keyframes smileFlash {
  0%, 100% { opacity: 0; }
  50% { opacity: 0.6; }
}

/* Apply animations */
#left-eyelid.blink, #right-eyelid.blink {
  animation: blink 4s infinite;
}

#head-group.bobble {
  animation: headBobble 6s ease-in-out infinite;
}

#body.breathe {
  animation: breathe 4s ease-in-out infinite;
}

#right-forearm.wave {
  animation: waveHand 1.2s ease-in-out;
  transform-origin: top;
}

#head-group.nod {
  animation: nodHead 1.5s ease-in-out;
  transform-origin: center bottom;
}

#head-group.shake {
  animation: shakeHead 1.5s ease-in-out;
  transform-origin: center bottom;
}

#right-arm.shrug, #left-arm.shrug {
  animation: shrug 1.2s ease-in-out;
}

#avatar-main.excited {
  animation: excited 1.5s ease-in-out;
}

#left-pupil, #right-pupil {
  animation: pupilMove 8s ease-in-out infinite;
}

#left-arm {
  animation: leftArmIdle 7s ease-in-out infinite;
}

#right-arm {
  animation: rightArmIdle 7s ease-in-out infinite;
}

#smile-line-left.smile, #smile-line-right.smile {
  animation: smileFlash 2s ease-in-out;
}

/* Viseme classes for lip syncing - more subtle movements */
.viseme-a #mouth-current {
  d: path('M120,160 Q150,180 180,160 Q150,190 120,160');
  fill: #701f29;
}

.viseme-e #mouth-current {
  d: path('M120,160 Q150,175 180,160 Q150,185 120,160');
  fill: #701f29;
}

.viseme-i #mouth-current {
  d: path('M130,160 Q150,165 170,160 Q150,170 130,160');
  fill: #701f29;
}

.viseme-o #mouth-current {
  d: path('M130,155 Q150,175 170,155 Q150,185 130,155');
  fill: #701f29;
}

.viseme-u #mouth-current {
  d: path('M135,160 Q150,170 165,160 Q150,180 135,160');
  fill: #701f29;
}

.viseme-m #mouth-current {
  d: path('M120,160 L180,160');
  fill: none;
}

/* Expression classes - more natural */
.expression-happy #mouth-current {
  d: path('M120,155 Q150,175 180,155');
  fill: none;
}

.expression-happy #smile-line-left, .expression-happy #smile-line-right {
  opacity: 0.5;
}

.expression-happy #left-eyebrow {
  d: path('M100,95 Q120,88 140,98');
}

.expression-happy #right-eyebrow {
  d: path('M160,98 Q180,88 200,95');
}

.expression-sad #mouth-current {
  d: path('M120,165 Q150,155 180,165');
  fill: none;
}

.expression-sad #left-eyebrow {
  d: path('M100,98 Q120,92 140,90');
}

.expression-sad #right-eyebrow {
  d: path('M160,90 Q180,92 200,98');
}

.expression-surprised #mouth-current {
  d: path('M130,160 Q150,180 170,160 Q150,185 130,160');
  fill: #701f29;
}

.expression-surprised #left-eyebrow {
  d: path('M100,85 Q120,75 140,85');
}

.expression-surprised #right-eyebrow {
  d: path('M160,85 Q180,75 200,85');
}

.expression-thinking #right-eyebrow {
  d: path('M160,90 Q180,80 200,95');
}

.expression-thinking #left-eyebrow {
  d: path('M100,92 Q120,90 140,90');
}

.expression-confused #left-eyebrow {
  d: path('M100,92 Q120,83 140,94');
}

.expression-confused #right-eyebrow {
  d: path('M160,92 Q180,99 200,94');
}

.expression-angry #left-eyebrow {
  d: path('M100,95 Q120,85 140,98');
}

.expression-angry #right-eyebrow {
  d: path('M160,98 Q180,85 200,95');
}

.expression-angry #mouth-current {
  d: path('M120,165 Q150,160 180,165');
  fill: none;
}

/* Additional animations for natural body movement */
@keyframes adjustPosture {
  0% { transform: translateY(0) rotate(0deg); }
  30% { transform: translateY(-2px) rotate(0.5deg); }
  70% { transform: translateY(-1px) rotate(-0.3deg); }
  100% { transform: translateY(0) rotate(0deg); }
}

@keyframes subtleEyebrowRaise {
  0% { transform: translateY(0); }
  40% { transform: translateY(-1px); }
  100% { transform: translateY(0); }
}

@keyframes subtleEyeWiden {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

/* Apply the new animations */
#body.adjustPosture {
  animation: adjustPosture 2s ease-in-out;
}

/* Apply subtle head bobble during speaking */
.speaking #head-group {
  animation: headBobble 4s ease-in-out infinite;
}

/* Micro-expressions - subtle and brief */
.micro-expression-happy #left-eyebrow,
.micro-expression-happy #right-eyebrow {
  animation: subtleEyebrowRaise 0.3s ease-in-out;
}

.micro-expression-happy #mouth-current {
  d: path('M120,158 Q150,165 180,158');
}

.micro-expression-surprised #left-eye ellipse,
.micro-expression-surprised #right-eye ellipse {
  animation: subtleEyeWiden 0.3s ease-in-out;
}

.micro-expression-surprised #left-eyebrow,
.micro-expression-surprised #right-eyebrow {
  transform: translateY(-1px);
}

.micro-expression-thinking #right-eyebrow {
  transform: translateY(-1px);
}

/* Ensure more subtle transitions between expressions */
#left-eyebrow, #right-eyebrow, #mouth-current {
  transition: d 0.3s ease-in-out;
}

/* Add subtle transitions for transforms */
#head-group, #left-arm, #right-arm, #left-pupil, #right-pupil {
  transition: transform 0.2s ease-in-out;
}

/* Natural eyelid movement */
#left-eyelid, #right-eyelid {
  transition: opacity 0.15s ease-in-out;
}

/* Add a subtle shadow effect for depth */
#shadow {
  animation: shadowPulse 4s ease-in-out infinite;
}

@keyframes shadowPulse {
  0%, 100% { opacity: 0.1; }
  50% { opacity: 0.12; }
}

/* Make fingers more reactive during gestures */
.wave #right-hand path {
  animation: fingerWiggle 1.2s ease-in-out;
}

@keyframes fingerWiggle {
  0%, 100% { transform: rotate(0deg); }
  25%, 75% { transform: rotate(5deg); }
  50% { transform: rotate(-3deg); }
}

/* Add a subtle color shift for more lifelike appearance */
@keyframes subtleColorShift {
  0%, 100% { fill: #e1b496; }
  50% { fill: #d9ad8f; }
}

#head {
  animation: subtleColorShift 8s ease-in-out infinite;
}

/* Add more natural expressions */
.expression-confused #mouth-current {
  d: path('M125,162 Q150,165 175,162');
}

/* Make eyelids blink at slightly different times for more natural look */
#left-eyelid.blink {
  animation-delay: 0.03s;
}
